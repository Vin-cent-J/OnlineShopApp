<ion-content [fullscreen]="true" class="register-content">
  <div class="register-container">
    <ion-card class="register-card">
      <div class="card-header">
        <h2>Register</h2>
        <p>Isi detail pengguna untuk membuat akun</p>
      </div>

      <div class="input-container">
        <ion-label class="above-label">Nama</ion-label>
        <ion-item class="input-item">
          <ion-input [(ngModel)]="nama" type="text" required placeholder="Masukkan nama"></ion-input>
        </ion-item>
      </div>
      <ion-text *ngIf="nameError" color="danger" class="error-message">
        <ion-icon name="alert-circle-outline"></ion-icon>
        {{ nameError }}
      </ion-text>

      <div class="input-container">
        <ion-label class="above-label">No Handphone</ion-label>
        <ion-item class="input-item">
          <ion-input [(ngModel)]="nohp" type="tel" inputmode="numeric" (ngModelChange)="validatePhoneNumber()"
            required placeholder="Masukkan nomor handphone"></ion-input>
        </ion-item>
      </div>
      <ion-text *ngIf="phoneError" color="danger" class="error-message">
        <ion-icon name="alert-circle-outline"></ion-icon>
        {{ phoneError }}
      </ion-text>

      <div class="input-container">
        <ion-label class="above-label">Alamat</ion-label>
        <ion-item class="input-item">
          <ion-input [(ngModel)]="alamat" type="text" required placeholder="Masukkan alamat pengiriman"></ion-input>
        </ion-item>
        <ion-select label="Provinsi" (ionChange)="handleChange($event)" required>
          <ion-select-option *ngFor="let p of provinsi" [value]="p" >{{p.nama}}</ion-select-option>
        </ion-select>
        <ion-select label="Kota/Kabupaten" (ionChange)="onChange($event)" required>
          <ion-select-option *ngFor="let k of kota" [value]="k" >{{k.nama}}</ion-select-option>
        </ion-select>
      </div>

      <ion-text *ngIf="addressError" color="danger" class="error-message">
        <ion-icon name="alert-circle-outline"></ion-icon>
        {{ addressError }}
      </ion-text>

      <!-- Password Field -->
      <div class="input-container">
        <ion-label class="above-label">Password</ion-label>
        <ion-item class="input-item">
          <ion-input [(ngModel)]="password" [type]="passwordType" required placeholder="Masukkan password"></ion-input>
          <ion-button fill="clear" size="small" slot="end" (click)="togglePasswordVisibility()">
            {{ passwordType === 'password' ? 'Show' : 'Hide' }}
          </ion-button>
        </ion-item>
      </div>
      <ion-text *ngIf="passwordError" color="danger" class="error-message">
        <ion-icon name="alert-circle-outline"></ion-icon>
        {{ passwordError }}
      </ion-text>

      <!-- Register Button -->
      <ion-button expand="block" class="register-button" (click)="register()" [disabled]="loading">
        <ion-spinner *ngIf="loading" slot="start"></ion-spinner>
        {{ loading ? 'Mendaftarkan...' : 'Daftar' }}
      </ion-button>

      <ion-text *ngIf="registerError" color="danger" class="error-message">
        <p>{{registerError}}</p>
      </ion-text>
    </ion-card>
  </div>
</ion-content>
